```mermaid
sequenceDiagram
    participant U as ðŸ‘¤ ç”¨æˆ·
    participant UI as ðŸ“± å‰ç«¯
    participant W as ðŸ” é’±åŒ…
    participant UNI as ðŸ¦„ Uniswap
    participant GEM as ðŸ’Ž GemToken
    participant BB as ðŸŽ BlindBox
    participant NFT as ðŸŽ¨ GenesisMecha
    
    Note over U,NFT: ðŸš€ å¼€ç›²ç›’å®Œæ•´æµç¨‹
    
    %% 1. èŽ·å– GEM ä»£å¸
    rect rgb(255, 240, 200)
        Note over U,UNI: ðŸ’° èŽ·å– GEM ä»£å¸ (å¦‚æžœä½™é¢ä¸è¶³)
        U->>UI: ç‚¹å‡»"èŽ·å– GEM"
        UI->>W: å‘èµ· Uniswap äº¤æ¢
        W->>UNI: swapExactETHForTokens()
        UNI-->>W: è¿”å›ž GEM ä»£å¸
        W-->>U: ä½™é¢æ›´æ–°
    end
    
    %% 2. æŽˆæƒ GEM ä»£å¸
    rect rgb(230, 255, 230)
        Note over U,GEM: âœ… æŽˆæƒ GEM ä»£å¸
        U->>UI: ç‚¹å‡»"æŽˆæƒ"
        UI->>W: å‘èµ·æŽˆæƒäº¤æ˜“
        W->>GEM: approve(BlindBox, amount)
        GEM-->>W: æŽˆæƒæˆåŠŸ
        W-->>UI: äº¤æ˜“ç¡®è®¤
        UI-->>U: æ˜¾ç¤ºæŽˆæƒæˆåŠŸ
    end
    
    %% 3. è´­ä¹°ç›²ç›’
    rect rgb(240, 230, 255)
        Note over U,NFT: ðŸŽ è´­ä¹°ç›²ç›’å¹¶é“¸é€  NFT
        U->>UI: ç‚¹å‡»"è´­ä¹°ç›²ç›’"
        UI->>W: å‘èµ·è´­ä¹°äº¤æ˜“
        W->>BB: purchaseBlindBox(amount)
        
        BB->>GEM: transferFrom(user, contract, price)
        GEM-->>BB: è½¬è´¦æˆåŠŸ
        
        BB->>BB: ç”Ÿæˆéšæœºå…ƒæ•°æ®ç´¢å¼•
        
        BB->>NFT: mint(user, tokenId)
        NFT-->>BB: é“¸é€ æˆåŠŸ
        
        BB->>NFT: setTokenURI(tokenId, metadataURI)
        NFT-->>BB: å…ƒæ•°æ®è®¾ç½®æˆåŠŸ
        
        BB-->>W: å‘é€ BlindBoxPurchased äº‹ä»¶
        W-->>UI: äº¤æ˜“ç¡®è®¤
        UI-->>U: æ˜¾ç¤º NFT èŽ·å¾—æˆåŠŸ
    end
    
    %% 4. æŸ¥çœ‹ç»“æžœ
    rect rgb(255, 245, 245)
        Note over U,NFT: ðŸŽ‰ æŸ¥çœ‹èŽ·å¾—çš„ NFT
        U->>UI: æŸ¥çœ‹æˆ‘çš„ NFT
        UI->>NFT: tokenURI(tokenId)
        NFT-->>UI: è¿”å›žå…ƒæ•°æ® URI
        UI->>UI: èŽ·å–å…ƒæ•°æ®å†…å®¹
        UI-->>U: æ˜¾ç¤º NFT è¯¦æƒ…
    end
```